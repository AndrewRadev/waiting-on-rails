#! /usr/bin/env ruby

$: << File.expand_path('../../lib', __FILE__)

require 'waiting_on_rails/player'
require 'pty'

slow_tasks = [
  'routes',
]

player = WaitingOnRails::Player.new

if ARGV.any? { |task| slow_tasks.include?(task) }
  player.start
  pid = spawn 'rake', *ARGV
  Process.wait(pid)
  player.stop
else
  exec 'rake', *ARGV
end
